# Реализация микросервисов на python

[Технологический радар](https://magnit-tech.github.io/magnit-online/tech/radar/python/index.html)

Пишем микросервисы среднего слоя на python.

## Технологии

- python = 3.9.x
- FastAPI - как http web фреймворк
- uvicorn - как ASGI server
- poetry - как пакетный менеджер для установки зависимостей
- sqlalchemy/aoipg - как драйвер для работы с postgresql
- alembic - для миграций
- httpx - как библиотека для написания http клиентов до других API
- pydantic
    - как библиотека для описания структур данных как внутри микросервиса так и для выдачи данных в ответе http
    - как библиотека для конфигурирования приложения через env переменные
- aiocron - для реализации фоновых задач запускаемых по расписанию
- aioredlock - при необходимости реализации распределенных локов между подами внутри кубера
- aiocache/aioredis - для кеширования чего-либо в redis

Код должен быть покрыт type hinting, который должен проверяться через mypy

Код должен быть отформатирован через  black/isort/pyflakes

## Локальный запуск

Проект должен содержать makefile, в котором должны быть описаны все способы запуска локально:

- сервера
- тестов
- проверок на форматирование кода
- проверок на mypy
- миграций

## Запуск в докер контейнере

Проект должен содержать docker-compose файл, в котором должны быть описаны все способы запуска сервера в докер образе локально со всеми необходимыми зависимостями

## CICD

- проверка кода на форматирование через black/isort/pyflakes
- сборка докер образов: dev/prod
- проверка кода на type hinting через mypy
- запуск тестов. Минимальное покрытие тестами кода - 90%
- smoke test
- деплой
